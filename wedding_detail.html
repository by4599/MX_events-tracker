<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>추가 정보 입력</title>
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:0;padding:24px;background:#f9f9f9;color:#111}
.card{max-width:720px;margin:0 auto;background:#fff;padding:24px;border-radius:16px;box-shadow:0 2px 6px rgba(0,0,0,0.1)}
h2{margin-top:0}
label{display:block;margin:12px 0 6px;font-weight:600}
input,select{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;box-sizing:border-box}
.btn{padding:12px 16px;border:0;border-radius:8px;cursor:pointer;font-weight:600}
.btn.primary{background:#111;color:#fff;width:100%;margin-top:16px}
.preview{white-space:pre-wrap;border:1px solid #ddd;padding:16px;border-radius:12px;background:#fafafa;margin-top:16px}
.hidden{display:none}
</style>
</head>
<body>
<div class="card">
  <h2>추가 정보 입력</h2>

  <label>임원 성함 *</label>
  <input id="name" />
  <label>재직/퇴직 *</label>
  <select id="empStatus"><option value="">선택</option><option>재직</option><option>퇴직</option></select>
  <label>근무 부서 *</label>
  <input id="deptWhenEmployed" />
  <label>현 직장/직책 *</label>
  <input id="currentJobTitle" />
  <label>청탁금지법 대상 여부 *</label>
  <select id="antiGraft"><option value="">선택</option><option>대상</option><option>비대상</option></select>
  <label>축의계좌 *</label>
  <input id="bankNumber" />
  <label>은행 *</label>
  <select id="bankName"><option value="">선택</option><option>국민</option><option>신한</option><option>우리</option><option>하나</option><option>농협</option><option>기업</option></select>
  <label>연락처 *</label>
  <input id="phone" placeholder="010-1234-5678" />
  <label>퇴임임원 문자 알림 계좌번호 공개 여부 *</label>
  <select id="accountDisclosure"><option value="">선택</option><option>희망</option><option>비희망</option></select>

  <button class="btn primary" id="btnPreview">게시글 미리보기</button>
  <div id="previewBox" class="preview hidden"></div>
  <button class="btn primary" id="btnSubmit">제출</button>
</div>

<script>
const invite=JSON.parse(localStorage.getItem('inviteInfo')||'{}');

// 미리보기
document.getElementById('btnPreview').addEventListener('click',()=>{
  const name=document.getElementById('name').value;
  const job=document.getElementById('currentJobTitle').value;
  const phone=document.getElementById('phone').value;
  const bank=document.getElementById('bankName').value;
  const bankNum=document.getElementById('bankNumber').value;

  const preview=`${invite.groomFather} ∙ ${invite.groomMother} 의 ${invite.groomOrder} ${invite.groomName}
${invite.brideFather} ∙ ${invite.brideMother} 의 ${invite.brideOrder} ${invite.brideName}
□ 일 시 : ${invite.eventDate} ${invite.eventTime}
□ 장 소 : ${invite.venue}
           (${invite.venueAddr})
□ 연락처 : ${phone} (${name} ${job})
□ 축의계좌 : ${bank} ${bankNum} (${name})
□ 스몰웨딩 여부 : ${invite.isSmallWedding}
□ 청첩장 URL : ${invite.noInvite?"없음":invite.inviteUrl}`;

  document.getElementById('previewBox').textContent=preview;
  document.getElementById('previewBox').classList.remove('hidden');
});

// 제출
document.getElementById('btnSubmit').addEventListener('click',async()=>{
  const payload={
    ...invite,
    name:document.getElementById('name').value,
    empStatus:document.getElementById('empStatus').value,
    deptWhenEmployed:document.getElementById('deptWhenEmployed').value,
    currentJobTitle:document.getElementById('currentJobTitle').value,
    antiGraft:document.getElementById('antiGraft').value,
    bankNumber:document.getElementById('bankNumber').value,
    bankName:document.getElementById('bankName').value,
    phone:document.getElementById('phone').value,
    accountDisclosure:document.getElementById('accountDisclosure').value
  };

  const ENDPOINT="https://script.google.com/macros/s/AKfycbyY9JgPGnVIy2MlpLlxb06P9LaWamoVtx5Kn-Uo9rTXFIqrPChVyNbzI1g3ox7drytP7g/exec";
  try{
    const res=await fetch(ENDPOINT,{method:"POST",body:JSON.stringify(payload)});
    const result=await res.json();
    alert(result.ok?"제출 완료!":"제출 실패: "+result.error);
  }catch(err){
    alert("제출 오류: "+err.message);
  }
});
</script>
</body>
</html>

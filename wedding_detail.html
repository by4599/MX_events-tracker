<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ì¶”ê°€ ì •ë³´ ì…ë ¥</title>
<style>
body {
  font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  margin:0; padding:16px; background:#f9f9f9; color:#111;
}
.card {
  max-width:420px; margin:0 auto; background:#fff; padding:16px;
  border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,0.1);
}
h2 { margin-top:0; font-size:18px }
.row-inline {
  display:flex; align-items:center; gap:6px; margin:8px 0;
  flex-wrap:wrap;
}
.row-inline label {
  flex:0 0 120px; font-size:14px; font-weight:600;
}
.row-inline input, .row-inline select {
  flex:1; min-width:0;
  padding:8px; font-size:14px;
  border:1px solid #ccc; border-radius:6px;
}
.btn {
  padding:10px 12px; border:0; border-radius:6px;
  cursor:pointer; font-weight:600; font-size:14px;
}
.btn.primary { background:#111; color:#fff; width:100%; margin-top:12px }
.preview {
  white-space:pre-wrap; border:1px solid #ddd; padding:12px;
  border-radius:12px; background:#fafafa; margin-top:12px; font-size:14px;
}
.hidden { display:none }
</style>
</head>
<body>
<div class="card">
  <h2>ì¶”ê°€ ì •ë³´ ì…ë ¥</h2>

  <div class="row-inline">
    <label for="name">ì„ì› ì„±í•¨ *</label>
    <input id="name" placeholder="ì˜ˆ: ê¹€ì„í˜¸">
  </div>

  <div class="row-inline">
    <label>ì„ì›ì¸¡ *</label>
    <div>
      <label><input type="radio" name="parentSide" value="groom"> ì‹ ë‘ì¸¡</label>
      <label><input type="radio" name="parentSide" value="bride"> ì‹ ë¶€ì¸¡</label>
    </div>
  </div>

  <div class="row-inline">
    <label for="empStatus">ì¬ì§/í‡´ì„ *</label>
    <select id="empStatus">
      <option value="">ì„ íƒ</option>
      <option>ì¬ì§</option>
      <option>í‡´ì„</option>
    </select>
  </div>

  <div class="row-inline">
    <label for="deptWhenEmployed">ê·¼ë¬´ ë¶€ì„œ *</label>
    <input id="deptWhenEmployed" placeholder="ì˜ˆ: ë¬´ì„ ì‚¬ì—…ë¶€">
  </div>

  <div class="row-inline">
    <label for="currentJobTitle">ì§ì±… *</label>
    <input id="currentJobTitle" placeholder="ì˜ˆ: ìƒë¬´">
    <span id="jobStatusNote" style="color:#555;font-size:12px"></span>
  </div>

  <div class="row-inline">
    <label for="antiGraft">ì²­íƒê¸ˆì§€ë²• *</label>
    <select id="antiGraft">
      <option value="">ì„ íƒ</option>
      <option>ëŒ€ìƒ</option>
      <option>ë¹„ëŒ€ìƒ</option>
    </select>
  </div>

  <div class="row-inline">
    <label for="bankNumber">ì¶•ì˜ê³„ì¢Œ *</label>
    <input id="bankNumber" placeholder="ê³„ì¢Œë²ˆí˜¸">
  </div>

  <div class="row-inline">
    <label for="bankName">ì€í–‰ *</label>
    <select id="bankName">
      <option value="">ì„ íƒ</option>
      <option>êµ­ë¯¼</option><option>ì‹ í•œ</option><option>ìš°ë¦¬</option>
      <option>í•˜ë‚˜</option><option>ë†í˜‘</option><option>ê¸°ì—…</option>
    </select>
  </div>

  <div class="row-inline">
    <label for="phone">ì—°ë½ì²˜ *</label>
    <input id="phone" placeholder="010-1234-5678">
  </div>

  <div class="row-inline">
    <label for="accountDisclosure">ê³„ì¢Œê³µê°œ *</label>
    <select id="accountDisclosure">
      <option value="">ì„ íƒ</option>
      <option>í¬ë§</option>
      <option>ë¹„í¬ë§</option>
    </select>
  </div>

  <button class="btn primary" id="btnPreview">ê²Œì‹œê¸€ ë¯¸ë¦¬ë³´ê¸°</button>
  <div id="previewBox" class="preview hidden"></div>
  <button class="btn primary" id="btnSubmit">ì œì¶œ</button>
  <div id="submitMsg" class="hidden"></div>
</div>

<script>
const ENDPOINT="https://wedding-proxy.ini203-kim.workers.dev";
const invite=JSON.parse(localStorage.getItem('inviteInfo')||'{}');

// ì—°ë½ì²˜ ìë™ í•˜ì´í”ˆ
document.getElementById('phone').addEventListener('input',(e)=>{
  let num=e.target.value.replace(/\D/g,"");
  if(num.length===10){
    num=num.replace(/(\d{2,3})(\d{3,4})(\d{4})/,"$1-$2-$3");
  }else if(num.length===11){
    num=num.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3");
  }
  e.target.value=num;
});

// ğŸŸ¢ í‡´ì„ ì„ íƒ ì‹œë§Œ "(ì¬ì§ì¤‘)" í‘œì‹œ
document.getElementById('empStatus').addEventListener('change',(e)=>{
  if(e.target.value==="í‡´ì„"){
    document.getElementById('jobStatusNote').innerText="(ì¬ì§ì¤‘)";
  }else{
    document.getElementById('jobStatusNote').innerText="";
  }
});

// ğŸŸ¢ ë¯¸ë¦¬ë³´ê¸° (ë‹¨ìˆœ ì˜ˆì‹œ, ìƒì„¸ëŠ” ê¸°ì¡´ ë¡œì§ê³¼ ê²°í•© í•„ìš”)
document.getElementById('btnPreview').addEventListener('click',()=>{
  const side=document.querySelector('input[name="parentSide"]:checked')?.value;
  const empStatus=document.getElementById('empStatus').value;
  const dept=document.getElementById('deptWhenEmployed').value;
  const name=document.getElementById('name').value;
  const job=document.getElementById('currentJobTitle').value;
  const phone=document.getElementById('phone').value;
  const bank=document.getElementById('bankName').value;
  const bankNum=document.getElementById('bankNumber').value;
  const anti=document.getElementById('antiGraft').value;

  let header="";
  if(empStatus==="ì¬ì§"){
    header=`ì‚¼ì„±ì „ì ${dept} ${name} ${job} ${side==="groom"?invite.groomOrder:invite.brideOrder}ê²°í˜¼ì„ ì•ˆë‚´í•˜ì˜¤ë‹ˆ\në§ì€ ì¶•í•˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤.\n\n`;
  }else if(empStatus==="í‡´ì„"){
    header=`ì „)ì‚¼ì„±ì „ì ${dept} ${name} ${job} ${side==="groom"?invite.groomOrder:invite.brideOrder}ê²°í˜¼ì„ ì•ˆë‚´í•˜ì˜¤ë‹ˆ\në§ì€ ì¶•í•˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤.\n\n`;
  }

  let familyBlock="";
  if(side==="groom"){
    familyBlock=`${invite.groomFather} Â· ${invite.groomMother} ì˜ ${invite.groomOrder} ${invite.groomName}\n`+
                `${invite.brideFather} Â· ${invite.brideMother} ì˜ ${invite.brideOrder} ${invite.brideName}\n\n`;
  }else if(side==="bride"){
    familyBlock=`${invite.brideFather} Â· ${invite.brideMother} ì˜ ${invite.brideOrder} ${invite.brideName}\n`+
                `${invite.groomFather} Â· ${invite.groomMother} ì˜ ${invite.groomOrder} ${invite.groomName}\n\n`;
  }

  let schedule=`â–¡ ì¼ ì‹œ : ${invite.eventDate} ${invite.eventTime}\n`+
               `â–¡ ì¥ ì†Œ : ${invite.venueDetail}\n   (${invite.venueAddr})\n`+
               `â–¡ ì—°ë½ì²˜ : ${phone} (${name} ${job})\n`+
               `â–¡ ì¶•ì˜ê¸ˆ ì „ë‹¬ê³„ì¢Œ : ${bank}ì€í–‰ ${bankNum} (${name})\n`;

  if(anti==="ëŒ€ìƒ") schedule+=`\nâ€» ì²­íƒê¸ˆì§€ë²• ëŒ€ìƒ`;
  if(anti==="ë¹„ëŒ€ìƒ") schedule+=`\nâ€» ì²­íƒê¸ˆì§€ë²• ë¹„ëŒ€ìƒ`;

  document.getElementById('previewBox').innerText=header+familyBlock+schedule;
  document.getElementById('previewBox').classList.remove('hidden');
});
</script>
</body>
</html>

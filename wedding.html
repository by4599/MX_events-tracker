<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>모바일 청첩장 분석</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:0;padding:16px;background:#f9f9f9;color:#111}
    .card{max-width:420px;margin:0 auto;background:#fff;padding:16px;
      border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1)}
    h2{margin-top:0;font-size:18px}
    .row-inline{display:flex;align-items:center;gap:6px;margin:8px 0;flex-wrap:wrap}
    .row-inline label{flex:0 0 120px;font-size:14px;font-weight:600}
    .row-inline input{flex:1;min-width:0;padding:8px;font-size:14px;border:1px solid #ccc;border-radius:6px}
    .btn{padding:10px 12px;border:0;border-radius:6px;cursor:pointer;font-weight:600;font-size:14px}
    .btn.primary{background:#111;color:#fff;width:100%;margin-top:12px}
    #msg{margin-top:12px;font-size:14px}
  </style>
</head>
<body>
<div class="card">
  <h2>청첩장 URL 입력</h2>
  <div class="row-inline">
    <label for="inviteUrl">청첩장 URL</label>
    <input id="inviteUrl" type="url" placeholder="https://example.com"/>
  </div>
  <button class="btn primary" id="btnAnalyze">AI로 예식 정보 확인</button>
  <div id="msg"></div>
</div>

<script>
const ENDPOINT = "https://script.google.com/macros/s/AKfycbyY9JgPGnVIy2MlpLlxb06P9LaWamoVtx5Kn-Uo9rTXFIqrPChVyNbzI1g3ox7drytP7g/exec";

document.getElementById("btnAnalyze").addEventListener("click", async ()=>{
  const url = document.getElementById("inviteUrl").value.trim();
  const msg = document.getElementById("msg");
  if(!url){
    msg.textContent="❌ URL을 입력해주세요.";
    msg.style.color="red";return;
  }
  msg.textContent="⏳ AI 분석 중...";
  msg.style.color="black";

  try {
    const res = await fetch(`${ENDPOINT}?action=extract&url=${encodeURIComponent(url)}`, { method:"GET" });
    if(!res.ok) throw new Error("서버 응답 오류");
    const data = await res.json();
    if(data.ok){
      localStorage.setItem("inviteInfo", JSON.stringify(data));
      msg.textContent="✅ AI 분석 완료. 추가정보 입력 페이지로 이동하세요.";
      msg.style.color="green";
      setTimeout(()=>location.href="wedding_detail.html",1500);
    }else{
      msg.textContent="❌ 분석 실패: "+(data.error||"알 수 없는 오류");
      msg.style.color="red";
    }
  } catch(err){
    msg.textContent="❌ 분석 요청 실패: "+err.message;
    msg.style.color="red";
  }
});
</script>
</body>
</html>

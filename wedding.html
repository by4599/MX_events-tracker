<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>결혼식 정보 입력</title>
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:0;padding:16px;background:#f9f9f9;color:#111}
.card{max-width:420px;margin:0 auto;background:#fff;padding:16px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1)}
h2{margin-top:0;font-size:18px}
label{display:block;margin:8px 0 4px;font-weight:600;font-size:14px}
input,select{width:100%;padding:8px;font-size:14px;border:1px solid #ccc;border-radius:6px;box-sizing:border-box}
.row{display:flex;gap:6px}
.btn{padding:10px 12px;border:0;border-radius:6px;cursor:pointer;font-weight:600;font-size:14px}
.btn.primary{background:#111;color:#fff;width:100%;margin-top:12px}
.checkbox{margin:8px 0;font-size:14px}
.section{margin-top:16px;padding-top:12px;border-top:1px solid #eee}
.msg{margin-top:8px;font-size:13px}
</style>
</head>
<body>
<div class="card">
  <h2>결혼식 기본 정보 입력</h2>

  <!-- 청첩장 URL -->
  <label for="inviteUrl">모바일 청첩장 URL</label>
  <input id="inviteUrl" placeholder="https://..." />
  <div class="checkbox">
    <label><input type="checkbox" id="noInvite"> 모바일 청첩장 없음</label>
  </div>
  <button class="btn primary" id="btnCheck">AI로 예식 정보 확인</button>
  <div id="msg" class="msg"></div>

  <!-- 신랑측 -->
  <div class="section">
    <h3>신랑측</h3>
    <label for="groomFather">혼주 아버지 성함 *</label>
    <input id="groomFather" />
    <label for="groomMother">혼주 어머니 성함 *</label>
    <input id="groomMother" />
    <label for="groomOrder">신랑 형제관계 *</label>
    <select id="groomOrder">
      <option value="">선택</option>
      <option>장남</option><option>차남</option><option>삼남</option>
    </select>
    <label for="groomName">신랑 성명 *</label>
    <input id="groomName" />
  </div>

  <!-- 신부측 -->
  <div class="section">
    <h3>신부측</h3>
    <label for="brideFather">혼주 아버지 성함 *</label>
    <input id="brideFather" />
    <label for="brideMother">혼주 어머니 성함 *</label>
    <input id="brideMother" />
    <label for="brideOrder">신부 형제관계 *</label>
    <select id="brideOrder">
      <option value="">선택</option>
      <option>장녀</option><option>차녀</option><option>삼녀</option>
    </select>
    <label for="brideName">신부 성명 *</label>
    <input id="brideName" />
  </div>

  <!-- 예식 정보 -->
  <div class="section">
    <h3>예식 정보</h3>
    <label>예식일시 *</label>
    <div class="row">
      <input type="date" id="eventDate" />
      <input type="time" id="eventTime" step="600" />
    </div>
    <small>해외의 경우 현지시간으로 입력 바랍니다.</small>
    <label for="venueAddr">예식장 주소 *</label>
    <input id="venueAddr" placeholder="도로명 주소 검색" />
    <label for="venueDetail">예식장 세부 *</label>
    <input id="venueDetail" placeholder="예식장 이름/홀명" />
    <label for="isSmallWedding">스몰웨딩 여부 *</label>
    <select id="isSmallWedding">
      <option value="">선택</option><option>예</option><option>아니오</option>
    </select>
    <label for="flower">화환 수령 *</label>
    <select id="flower">
      <option value="">선택</option><option>희망</option><option>비희망</option>
    </select>
  </div>

  <button class="btn primary" id="btnNext">추가 정보 입력</button>
</div>

<script>
const ENDPOINT="https://script.google.com/macros/s/AKfycbwsBf2tcQ_17Fpu_yDcEcn4uQDnZ0T8bU5L9KJtkgCCvXOsn5IfKEwVTP5_o7-fQmbvww/exec";

// AI 분석
document.getElementById('btnCheck').addEventListener('click', async ()=>{
  const msg=document.getElementById('msg');
  const url=document.getElementById('inviteUrl').value;
  if(!url){ msg.textContent="❌ 청첩장 URL을 입력하세요."; msg.style.color="red"; return; }
  msg.textContent="⏳ AI로 분석 중이니 잠시만 기다려주세요..."; msg.style.color="#333";
  try{
    const res=await fetch(ENDPOINT+"?action=extract&url="+encodeURIComponent(url));
    if(!res.ok) throw new Error("요청 실패");
    const data=await res.json();
    if(data.ok){
      document.getElementById('groomFather').value=data.groomFather||"";
      document.getElementById('groomMother').value=data.groomMother||"";
      document.getElementById('groomOrder').value=data.groomOrder||"";
      document.getElementById('groomName').value=data.groomName||"";
      document.getElementById('brideFather').value=data.brideFather||"";
      document.getElementById('brideMother').value=data.brideMother||"";
      document.getElementById('brideOrder').value=data.brideOrder||"";
      document.getElementById('brideName').value=data.brideName||"";
      document.getElementById('eventDate').value=data.eventDate||"";
      document.getElementById('eventTime').value=data.eventTime||"";
      document.getElementById('venueAddr').value=data.venueAddr||"";
      document.getElementById('venueDetail').value=data.venue||"";
      msg.textContent="✅ AI로 예식 정보가 입력되었습니다. 확인 바랍니다."; msg.style.color="green";
    }else{
      msg.textContent="❌ 분석 요청 실패: "+(data.error||"Unknown"); msg.style.color="red";
    }
  }catch(err){
    msg.textContent="❌ 분석 요청 실패: "+err.message; msg.style.color="red";
  }
});

// 다음 단계
document.getElementById('btnNext').addEventListener('click',()=>{
  const info={
    inviteUrl:document.getElementById('inviteUrl').value,
    noInvite:document.getElementById('noInvite').checked,
    groomFather:document.getElementById('groomFather').value,
    groomMother:document.getElementById('groomMother').value,
    groomOrder:document.getElementById('groomOrder').value,
    groomName:document.getElementById('groomName').value,
    brideFather:document.getElementById('brideFather').value,
    brideMother:document.getElementById('brideMother').value,
    brideOrder:document.getElementById('brideOrder').value,
    brideName:document.getElementById('brideName').value,
    eventDate:document.getElementById('eventDate').value,
    eventTime:document.getElementById('eventTime').value,
    venueAddr:document.getElementById('venueAddr').value,
    venueDetail:document.getElementById('venueDetail').value,
    isSmallWedding:document.getElementById('isSmallWedding').value,
    flower:document.getElementById('flower').value
  };
  localStorage.setItem('inviteInfo',JSON.stringify(info));
  location.href='wedding_detail.html';
});
</script>
</body>
</html>
